<#
.SYNOPSIS
    Registers the AppInstallerCLI package.
.DESCRIPTION
    Registers the loose files generated by the AppInstallerCLIPackage project
.PARAMETER PackageRoot
    The root of the package build output directory.  If not provided, assumed to be the local default
    location relative to this script.
#>
param(
    [Parameter(Mandatory=$false)]
    [string]$PackageRoot
)
if ([String]::IsNullOrEmpty($PackageRoot))
{
    $PackageRoot = Split-Path -Parent $PSCommandPath;
    $PackageRoot = Join-Path $PackageRoot "..\AppInstallerCLIPackage\bin\x64\Debug";
}
$PackageRoot = Resolve-Path $PackageRoot
Write-Host "Using PackageRoot = $PackageRoot"

Get-AppxPackage WinGetDevCLI 
Write-Host "Remove registered package"
Get-AppxPackage WinGetDevCLI | Remove-AppxPackage
$Local:AddScript = Join-Path $PackageRoot "Add-AppDevPackage.ps1"
Write-Host "Installing package at path: $Local:AddScript"
& $Local:AddScript -Force
Get-AppxPackage WinGetDevCLI 

